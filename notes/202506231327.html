<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>./einar.sh : Bits of string: compositional data</title>

  <meta name="description" content="Various writing, etc.">
  <meta name="author" content="Einar Holsbø">

  <script data-goatcounter="https://elleve.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>

  <link rel="stylesheet" href="/meta/main.css" />
  <link rel="stylesheet" href="/meta/syntax.css" />
</head>
<body>


<div class="menu">
  <a href="/">about</a>
  —
  <a href="/research/">research</a>
  —
  <a href="/talks/">talks</a>
  —
  <a href="/notes/">notes</a>
  —
  <a href="/links/">links</a>
  —
  <a href="/screenshot_garden/">screenshot garden</a>
  —
  <a href="/meta/"><em>meta</em></a>
</div>



<h1 id="bits-of-string-compositional-data">Bits of string: compositional
data</h1>
<p>(§) The article <a
href="https://link.springer.com/article/10.1007/s11222-024-10427-3">A
flexible Bayesian tool for CoDa mixed models</a> <span class="citation"
data-cites="Martinez-Minaya_2024">(Martı́nez-Minaya and Rue 2024)</span>
looks promising; it frames compositional count data in a way so that
it’s possible to fit by using INLA.</p>
<p>(§) Dimension of of log ratio vectors matters. Compare the CLR
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(-1, 1, 0)</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mi>…</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(-1, 1, 0, 0, \ldots)</annotation></semantics></math>
(a hundred zeros repeated). The former is roughly
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.09</mn><mo>,</mo><mn>0.67</mn><mo>,</mo><mn>0.24</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(0.09, 0.67, 0.24)</annotation></semantics></math>
in the simplex, while the latter is roughly
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.004</mn><mo>,</mo><mn>0.03</mn><mo>,</mo><mn>0.01</mn><mo>,</mo><mn>0.01</mn><mo>,</mo><mi>…</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(0.004, 0.03, 0.01, 0.01, \ldots)</annotation></semantics></math>,
which is practically uniform. The log ratios between coordinates 1 and 2
(or 1 and 3) remain the same however.</p>
<p>(§) Suppose we’re simulating (count) data where a subcomposition made
up of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>1</mn></msub><annotation encoding="application/x-tex">n_1</annotation></semantics></math>
components is active and the remaining
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>2</mn></msub><annotation encoding="application/x-tex">n_2</annotation></semantics></math>
components are inactive. We could start with centered (or some other)
log ratios and set the inactive variables to all-0, so we have a CLR
vector (choose your favorite basis)
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><msub><mi>n</mi><mn>1</mn></msub></msub><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mi>…</mi><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">x = (x_1, \ldots, x_{n_1}, 0, 0, \ldots, 0)</annotation></semantics></math>.
What size should
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>i</mi></msub><annotation encoding="application/x-tex">x_i</annotation></semantics></math>
be?</p>
<p>As the note above suggests this should depend on dimension. We could
decide that on average we want to have some set proportion,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>,
of counts to fall in the active subcomposition; let’s say
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>1</mn><mi>/</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">p = 1/4</annotation></semantics></math>.
Then the probabilities (for a multinomial draw) corresponding to the
active parts should sum to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">1/4</annotation></semantics></math>.
Since
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mtext mathvariant="normal">clr</mtext><mrow><mi>−</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>𝒞</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>e</mi><msub><mi>x</mi><mn>1</mn></msub></msup><mo>,</mo><mi>…</mi><mo>,</mo><msup><mi>e</mi><msub><mi>x</mi><msub><mi>n</mi><mn>1</mn></msub></msub></msup><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{clr}^{-1}(x) = \mathcal C(e^{x_1}, \ldots ,e^{x_{n_1}}, 1,1, \ldots, 1)</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝒞</mi><annotation encoding="application/x-tex">\mathcal C</annotation></semantics></math>
is the closure operator, this suggests that on average we want
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>∑</mo><msup><mi>e</mi><msub><mi>x</mi><mi>i</mi></msub></msup><mo>=</mo><msub><mi>n</mi><mn>2</mn></msub><mspace width="0.222em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mi>*</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">3\sum e^{x_i} = n_2\ (*)</annotation></semantics></math>.</p>
<p>We’ll draw independently
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>σ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X_i \sim N(0, \sigma)</annotation></semantics></math>
and choose
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
so that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>*</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(*)</annotation></semantics></math>
above is true on average. If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><mi>σ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y \sim N(\mu, \sigma)</annotation></semantics></math>
then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">E</mtext><msup><mi>e</mi><mi>Y</mi></msup><mo>=</mo><msup><mi>e</mi><mrow><mi>μ</mi><mo>+</mo><msup><mi>σ</mi><mn>2</mn></msup><mi>/</mi><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\text{E} e^Y = e^{\mu + \sigma^2/2}</annotation></semantics></math>
(cf. <a href="https://math.stackexchange.com/a/176330/121200">this</a>)
so if we take the expectation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>*</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(*)</annotation></semantics></math>
we get</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><msub><mi>n</mi><mn>1</mn></msub><msup><mi>e</mi><mrow><msup><mi>σ</mi><mn>2</mn></msup><mi>/</mi><mn>2</mn></mrow></msup><mo>=</mo><msub><mi>n</mi><mn>2</mn></msub><mo>⟹</mo><mi>σ</mi><mo>=</mo><msqrt><mrow><mn>2</mn><mo>ln</mo><mfrac><msub><mi>n</mi><mn>2</mn></msub><mrow><mn>3</mn><msub><mi>n</mi><mn>1</mn></msub></mrow></mfrac></mrow></msqrt><mi>.</mi></mrow><annotation encoding="application/x-tex">
3n_1e^{\sigma^2/2} = n_2 \implies \sigma = \sqrt{2\ln\frac{n_2}{3n_1}}.
</annotation></semantics></math></p>
<p><strong>Backlinks:</strong></p>
<ul>
<li><a href="/notes/202508181349.html">(202508181349)</a> Bits of
string</li>
</ul>
<div id="refs" class="references csl-bib-body hanging-indent"
data-entry-spacing="0" role="list">
<div id="ref-Martinez-Minaya_2024" class="csl-entry" role="listitem">
Martı́nez-Minaya, Joaquı́n, and Haavard Rue. 2024. <span>“A Flexible
Bayesian Tool for CoDa Mixed Models: Logistic-Normal Distribution with
Dirichlet Covariance.”</span> <em>Statistics and Computing</em> 34 (3):
116. <a
href="https://doi.org/10.1007/s11222-024-10427-3">https://doi.org/10.1007/s11222-024-10427-3</a>.
</div>
</div>




<small>this file last touched 2025.09.03</small></body>
</html>
