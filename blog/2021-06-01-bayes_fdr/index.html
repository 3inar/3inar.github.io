<!DOCTYPE html>
<html lang="en-us">

<head>
  <title>Note: Bayes false discovery rate | Just data things</title>

  <meta charset="UTF-8">
  <meta name="language" content="en">
  <meta name="description" content="A note in re Section 2.2 in Brad Efron&#39;s _Large-Scale Inference_">
  <meta name="keywords" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  
  
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Note: Bayes false discovery rate" />
  <meta name="twitter:description" content="A note in re Section 2.2 in Brad Efron&amp;#39;s _Large-Scale Inference_"/>
  <meta name="twitter:site" content="https://twitter.com/0xeinar" />
  <meta name="twitter:creator" content="https://twitter.com/0xeinar" />
  

  <link rel="shortcut icon" type="image/png" href="/favicon.ico" />


  
  
    
 
  
  
  
  
  
  
    
    <link type="text/css" rel="stylesheet" href="/css/post.min.86d1effd4c412b85ac13db53a90c473a0f256f789b821e131125c9aa25cb6a6d.css" integrity="sha256-htHv/UxBK4WsE9tTqQxHOg8lb3ibgh4TESXJqiXLam0="/>
  
    
    <link type="text/css" rel="stylesheet" href="/css/custom.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css" integrity="sha256-47DEQpj8HBSa&#43;/TImW&#43;5JCeuQeRkm5NMpJWZG3hSuFU="/>
  
  
   
   
    

<script type="application/ld+json">
  
    {
      "@context" : "http://schema.org",
      "@type" : "BlogPosting",
      "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/3inar.github.io\/"
      },
      "articleSection" : "blog",
      "name" : "Note: Bayes false discovery rate",
      "headline" : "Note: Bayes false discovery rate",
      "description" : "A note in re Section 2.2 in Brad Efron\u0027s _Large-Scale Inference_",
      "inLanguage" : "en-US",
      "author" : "",
      "creator" : "",
      "publisher": "",
      "accountablePerson" : "",
      "copyrightHolder" : "",
      "copyrightYear" : "2021",
      "datePublished": "2021-06-01 00:00:00 \u002b0000 UTC",
      "dateModified" : "2021-06-01 00:00:00 \u002b0000 UTC",
      "url" : "https:\/\/3inar.github.io\/blog\/2021-06-01-bayes_fdr\/",
      "wordCount" : "295",
      "keywords" : ["Blog"]
    }
  
  </script>
</head>

<body>
  <div class="burger__container">
  <div class="burger" aria-controls="navigation" aria-label="Menu">
    <div class="burger__meat burger__meat--1"></div>
    <div class="burger__meat burger__meat--2"></div>
    <div class="burger__meat burger__meat--3"></div>
  </div>
</div>
 

  <nav class="nav" id="navigation">
  <ul class="nav__list">
    
    
      <li>
        <a  href="/">about</a>
      </li>
    
      <li>
        <a  class="active"
         href="/blog">blog</a>
      </li>
    
      <li>
        <a  href="/research/">research</a>
      </li>
    
      <li>
        <a  href="/talks/">talks</a>
      </li>
    
  </ul>
</nav>


  <main>
    
    

    <div class="flex-wrapper">
      <div class="post__container">
        <div class="post">
          <header class="post__header">
            <h1 id="post__title">Note: Bayes false discovery rate</h1>
            <time datetime="2021-06-01 00:00:00 &#43;0000 UTC" class="post__date">Jun 1, 2021</time> 
          </header>
          <article class="post__content">
              



<p>This is a note to section 2.2 in Brad Efron’s book <em>Large-Scale Inference</em>, which I am very slowly working my way through.</p>
<p>In a large-scale -omic experiment we’re calculating thousands of <span class="math inline">\(Z_i = \frac{\mu_i}{\sigma_i/\sqrt{N}},\)</span><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> where the number of observations, <span class="math inline">\(N,\)</span> is likely below 100. Let’s say we’re working with gene expression: we use these statistics to evaluate the hypothesis that gene <span class="math inline">\(i\)</span> is differentially expressed between two groups of interest. In the nature of things you would not expect true differential expression of too many genes. But you should expect some number of false positives, viz, <span class="math inline">\(\alpha\)</span> of the genes that are not truly differentially expressed. Arguably this setting is mostly exploratory.</p>
<div id="a" class="section level1">
<h1>A</h1>
<p>In a microarray (or more recently RNA-Seq) experiment you measure the expression levels of tousands of genes for each a handful of people (or bacteria or what have you). Last I checked the sample sizes comprise mostly fewer than 100 observations in the large repositories for such data.</p>
<p>Whatever way you look at it, a full transcriptomic analysis has a substantial exploratory element. You don’t have a specific hypothesis for each of 20000 genes; what you probably have is the idea that for a given outcome a small fraction of genes will be differentially expressed between group A and group B.</p>
<pre class="r"><code>### unrelated, RE large-scale inference
F_0 &lt;- function(x) {pnorm(x)}
F_1 &lt;- function(x) { pnorm(x, sd=3) }
pi0 &lt;- 0.90
F_f &lt;- function(x) {pi0*F_0(x) + (1-pi0)*F_1(x)}

curve(F_f(x), from=-4, to=4)
curve(pi0*F_0(x), add=T)
curve(F_1(x), add=T)</code></pre>
<p><img src="/blog/2021-06-01-bayes_fdr_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>sq = seq(-5,-3.5, length.out = 500)
y = pi0*F_0(sq)
x = F_f(sq)
plot(x, y, type=&quot;l&quot;, xlab=&quot;F(Z)&quot;, ylab=&quot;pi0*F0(Z)&quot;); abline(0,1)

pt = c(F_f(-3.8), pi0*F_0(-3.8))
points(pt[1], pt[2], pch=20)</code></pre>
<p><img src="/blog/2021-06-01-bayes_fdr_files/figure-html/unnamed-chunk-2-2.png" width="672" /></p>
<pre class="r"><code>N = 1000
tv &lt;- rt(N, 1)
pis &lt;- sort(pnorm(tv))
plot(pis, type=&quot;l&quot;)
q &lt;- 0.1
tst &lt;- q*(1:N)/N
lines(tst)</code></pre>
<p><img src="/blog/2021-06-01-bayes_fdr_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>Though I am no biologist<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>


              
                  

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
            showMathMenu: false, //disables context menu
            tex2jax: {
            inlineMath: [ ['$','$'], ['\\(','\\)'] ]
           }
    });
</script>
              
          </article>
          

<ul class="tags__list">
    
    
    <li class="tag__item">
        <a class="tag__link" href="https://3inar.github.io/tags/efron/">efron</a>
    </li>
    <li class="tag__item">
        <a class="tag__link" href="https://3inar.github.io/tags/notes/">notes</a>
    </li>
    <li class="tag__item">
        <a class="tag__link" href="https://3inar.github.io/tags/fdr/">fdr</a>
    </li>
    <li class="tag__item">
        <a class="tag__link" href="https://3inar.github.io/tags/bayes/">bayes</a>
    </li></ul>

 <div class="pagination">
  
    <a class="pagination__item" href="https://3inar.github.io/blog/2021-05-13-stirglin/">
        <span class="pagination__label">Previous Post</span>
        <span class="pagination__title">Stirglin&#39;s approximation [sic]</span>
    </a>
  

  
</div>

          
          <footer class="post__footer">
            


<div class="social-icons">
  
     
    
      <a
        class="social-icons__link"
        title="Twitter"
        href="https://twitter.com/0xeinar"
        target="_blank"
        rel="me noopener"
      >
        <div class="social-icons__icon" style="background-image: url('https://3inar.github.io/svg/twitter.svg')"></div>
      </a>
    
  
     
    
      <a
        class="social-icons__link"
        title="GitHub"
        href="https://github.com/3inar"
        target="_blank"
        rel="me noopener"
      >
        <div class="social-icons__icon" style="background-image: url('https://3inar.github.io/svg/github.svg')"></div>
      </a>
    
  
     
    
      <a
        class="social-icons__link"
        title="stackexchange"
        href="https://stats.stackexchange.com/users/43625/"
        target="_blank"
        rel="me noopener"
      >
        <div class="social-icons__icon" style="background-image: url('https://3inar.github.io/svg/stackexchange.svg')"></div>
      </a>
    
     
</div>

            <p>© 2022</p>
          </footer>
          </div>
      </div>
      
    </div>
    

  </main>

   

  
  <script src="/js/index.min.301a8b0870381bf76b3b5182e8966d363a0474281183439beb024d8b8228fc66.js" integrity="sha256-MBqLCHA4G/drO1GC6JZtNjoEdCgRg0Ob6wJNi4Io/GY=" crossorigin="anonymous"></script>
  
  
  <script src="https://unpkg.com/prismjs@1.20.0/components/prism-core.min.js"></script>

  
  <script src="https://unpkg.com/prismjs@1.20.0/plugins/autoloader/prism-autoloader.min.js"
    data-autoloader-path="https://unpkg.com/prismjs@1.20.0/components/"></script>

  


</body>

</html>
