<!DOCTYPE html>
<html lang="en-US">
<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="description" content="Academic web page">
<meta name="keywords" content="statistics,machine learning,research,computer science">

<base href="http://3inar.github.io/">

<title>Einar Holsbø</title>

<meta name="generator" content="Hugo 0.34" />




<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">


<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400|Roboto+Slab:400,700|Roboto:300,300i,400,400i,500,500i,700,700i">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
<link rel="stylesheet" href="http://3inar.github.io/css/main.css">




<link rel="apple-touch-icon" sizes="180x180" href="http://3inar.github.io/apple-touch-icon.png">
<link rel="icon" type="image/png" href="http://3inar.github.io/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="http://3inar.github.io/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="http://3inar.github.io/manifest.json">
<link rel="mask-icon" href="http://3inar.github.io/safari-pinned-tab.svg" color="#5bbad5">
<meta name="theme-color" content="#ffffff">

</head>
<body lang="en-US">
<div class="container">


<script type="text/javascript"
   src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



<header class="row text-left title">
  <h1 class="title">Neural network overengineering</h1>
</header>
<section id="category-pane" class="row meta">
  
  <div class="col-md-12">
    <h6 class="text-left meta">
        PUBLISHED ON AUG 24, 2016 
      
    </h6>
  </div>
  
</section>
<section id="content-pane" class="row">
  <div class="col-md-12 text-left content">
    <p>In my idle hours (ie when I should have been writing a paper), I came across this blog post where the author <a href="https://medium.com/autonomous-agents/how-to-train-your-neuralnetwork-for-wine-tasting-1b49e0adff3a#.l2fhfa6hr">trained a neural netwok in the fine art of wine tasting</a>. I am basically deep down a very lazy person, and from what little I understand of NNs, there are quite a few knobs to fiddle with, which really who has the time with all this untasted wine floating about? 5.56 hidden nodes? 600 epochs? Feature scaling? Honestly! What I need is something <em>simple</em>.</p>
<p>Now for simplicity you can hardly beat good old Naive Bayes. For those of us who forget, Naive Bayes is to assume that the predictors <span class="math inline">\(x_i\)</span> in an observation <span class="math inline">\(\mathbf x = [x_1, x_1, \ldots, x_p]\)</span> are independent so that the probability of a given sample, <span class="math inline">\(\mathbf x\)</span>, belonging to a given class, <span class="math inline">\(C\)</span>, is <span class="math inline">\(p(C | X = \mathbf x) \propto p(C)\prod_{i=1}^p p(x_i|C)\)</span>. The class-conditional densities, <span class="math inline">\(p(x_i | C)\)</span>, are usually fit as maximum-likelihood-estimate Gaussians.</p>
<p>Anyway, <a href="https://archive.ics.uci.edu/ml/datasets/Wine">get the data from UCI</a> and have a go. Follow this simple guide and you too will have created a wine-tasting AI to threaten the job security of sommeliers everywhere. First let’s load the data and have a look at it.</p>
<pre class="r"><code>set.seed(220816) # for reproducibility 

# load data, first column in file is class
wino &lt;- read.csv(&quot;data/wine.data&quot;, header=F)
x &lt;- as.matrix(wino[, -1])
y &lt;- as.factor(wino[, 1])

# from wine.names
colnames(x) &lt;- c(&quot;Alcohol&quot;, &quot;Malic acid&quot;, &quot;Ash&quot;, &quot;Alcalinity of ash&quot;,
  &quot;Magnesium&quot;, &quot;Total phenols&quot;, &quot;Flavanoids&quot;, &quot;Nonflavanoid phenols&quot;,
  &quot;Proanthocyanins&quot;, &quot;Color intensity&quot;, &quot;Hue&quot;, &quot;OD280/OD315 of diluted wines&quot;,
  &quot;Proline&quot;)

# set aside 0.35 of the samples for independent test set as per other blog
test_idx &lt;- sample(1:length(y), ceiling(length(y)*0.35))</code></pre>
<p>To get a feel for the data we’ll plot the class-conditional densities of the different predictors. We exclude the training samples, of course, so as not to fool ourselves. The code for this plot is kind of ugly and unintersting so I’ll just hide it.</p>
<p><img src="http://3inar.github.io/blog/2016-08-24-neural-network-overengineering_files/figure-html/density_estimates-1.png" width="672" /></p>
<p>Doesn’t look too bad. Some of these don’t look particularly Gaussian, but let’s just say that we’re doing smoothing. Now to fit our model and look at how it classifies the different wines.</p>
<pre class="r"><code>library(e1071) # provides naiveBayes()</code></pre>
<pre><code>## Warning: package &#39;e1071&#39; was built under R version 3.3.2</code></pre>
<pre class="r"><code>nbfit &lt;- naiveBayes(x[-test_idx, ], y[-test_idx])

pred &lt;- predict(nbfit, x[test_idx, ], type=&quot;class&quot;)
confusion &lt;- table(pred, y[test_idx]); confusion</code></pre>
<pre><code>##     
## pred  1  2  3
##    1 18  0  0
##    2  0 29  0
##    3  0  1 15</code></pre>
<p>That’s a pretty friendly-looking confusion matrix; we only have a single misclassification. Accuracy is the number of correctly classified observations over the total number of observations classified:</p>
<pre class="r"><code>acc_est &lt;- sum(diag(confusion))/sum(confusion); acc_est</code></pre>
<pre><code>## [1] 0.984127</code></pre>
<p>So that’s pretty good. Since I believe in uncertainty estimates, we’ll do a bootstrapped quantile confidence interval. I estimate by 100% guessing that 5000 bootstrap samples is enough. Much more than enough probably.</p>
<pre class="r"><code>library(plyr)
boots &lt;- raply(5000, sample((1:nrow(x))[-test_idx], replace=T))

stats &lt;- aaply(boots, 1, function(bsindex) {
  nbfit &lt;- naiveBayes(x[bsindex, ], y[bsindex])

  pred &lt;- predict(nbfit, x[test_idx, ], type=&quot;class&quot;)
  confusion &lt;- table(pred, y[test_idx])
  sum(diag(confusion))/sum(confusion)
})

quantile(stats, c(0.025, 0.975))</code></pre>
<pre><code>##     2.5%    97.5% 
## 0.952381 1.000000</code></pre>
<p>The results are in: our intelligent wine tasting machine has an estimated accuracy of 0.98 with a 0.95 CI of [0.95, 1]. That’s good enough for me, and what’s more I never have to drink wine alone again.</p>

  </div>
</section>
<section id="tag-pane" class="row meta">
  
  <div class="col-md-12">
    <h6 class="text-right meta">
      
      
      
      TAGS:
      
      
      <a class="meta" href="http://3inar.github.io/tags/naive-bayes">NAIVE BAYES</a>, 
      
      <a class="meta" href="http://3inar.github.io/tags/neural-networks">NEURAL NETWORKS</a>, 
      
      <a class="meta" href="http://3inar.github.io/tags/wine">WINE</a>
      
      
      
    </h6>
  </div>
  
</section>








<section id="menu-pane" class="row menu text-center">
  
  
  
  <span><a class="menu-item" href="http://3inar.github.io/blog">blog</a></span>
  
  
  <span><a class="menu-item" href="http://3inar.github.io/blog/2016-10-03-violence/"> | next &gt;</a></span>
  
  
  <h4 class="text-center"><a class="menu-item" href="http://3inar.github.io/">home</a></h4>
</section>



<footer class="row text-center footer">
  <hr />
  
  <h6 class="text-center copyright"></h6>
  
  <h6 class="text-center powered">Powered by <a href="https://gohugo.io/">Hugo</a> &amp; <a href="https://github.com/shenoybr/hugo-goa">Goa</a>.</h6>
  
  
</footer>

</div>



<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  

<script type="text/javascript">
hljs.initHighlightingOnLoad();
</script>




<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="js/main.js"></script>
</body>
</html>


